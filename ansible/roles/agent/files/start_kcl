#!/bin/sh
source /opt/reflink/venv/bin/activate
source /opt/reflink/secrets

export PATH="/opt/reflink/arxiv-reflink:$PATH"

nohup java -cp /opt/reflink/jars/amazon-kinesis-client-1.7.6.jar:/opt/reflink/jars/aws-java-sdk-cloudwatch-1.11.151.jar:/opt/reflink/jars/aws-java-sdk-core-1.11.151.jar:/opt/reflink/jars/aws-java-sdk-dynamodb-1.11.151.jar:/opt/reflink/jars/aws-java-sdk-kinesis-1.11.151.jar:/opt/reflink/jars/aws-java-sdk-kms-1.11.151.jar:/opt/reflink/jars/aws-java-sdk-s3-1.11.151.jar:/opt/reflink/jars/commons-codec-1.9.jar:/opt/reflink/jars/commons-lang-2.6.jar:/opt/reflink/jars/commons-logging-1.1.3.jar:/opt/reflink/jars/guava-18.0.jar:/opt/reflink/jars/httpclient-4.5.2.jar:/opt/reflink/jars/httpcore-4.4.4.jar:/opt/reflink/jars/ion-java-1.0.2.jar:/opt/reflink/jars/jackson-annotations-2.6.0.jar:/opt/reflink/jars/jackson-core-2.6.6.jar:/opt/reflink/jars/jackson-databind-2.6.6.jar:/opt/reflink/jars/jackson-dataformat-cbor-2.6.6.jar:/opt/reflink/jars/jmespath-java-1.11.151.jar:/opt/reflink/jars/joda-time-2.8.1.jar:/opt/reflink/jars/protobuf-java-2.6.1.jar:/opt/reflink/arxiv-reflink com.amazonaws.services.kinesis.multilang.MultiLangDaemon /opt/reflink/bin/consumer.properties >> /var/log/reflinkconsumer.log 2>&1&
echo $!
